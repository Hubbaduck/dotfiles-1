##
## .bash_profile
##
## This is vaguely split into sections.
## With my custom prompt first,
## followed by shell options
## then path variables for everything I use.
## 

# shell color excapes
COLOR_YELLOW='\e[33m'
COLOR_CYAN='\e[36m'
COLOR_RESET='\e[0m'

# provide the git branch, if present
# a clean branch uses cyan, a dirty branch yellow
prompt_git() {
    git branch &>/dev/null || return 1
    HEAD="$(git symbolic-ref HEAD 2>/dev/null)"
    BRANCH="${HEAD##*/}"
    [[ -n "$(git status 2>/dev/null | \
        grep -F 'working directory clean')" ]] || STATUS=${COLOR_YELLOW}
    printf ${COLOR_CYAN}${STATUS}'(%s)'${COLOR_RESET} "${BRANCH:-unknown}"
}

# enable variables and commands in the prompt
shopt -s promptvars

# set the prompt (like: [user@machine:Current Directory](gitbranch)$)
export PS1='[\u@\h:\W]$(prompt_git)\$ '

# for tmux powerline
export PLATFORM="mac"

# fix a bug with OS X bash and EDITOR
export EDITOR=vim

# set the path
export PATH="/usr/local/bin:/usr/local/sbin:/usr/bin:/bin:/usr/sbin:/sbin:/opt/X11/bin"

# python
export PYTHONPATH="/usr/local/lib/python2.7/site-packages:$PYTHONPATH"
# haskell
export PATH="$HOME/.cabal/bin:$PATH"
# LaTeX
export PATH="/usr/local/texlive/2013/bin/x86_64-darwin:$PATH"
# Ruby (gems, specifically)
export PATH="/usr/local/opt/ruby/bin:$PATH"
# Heroku Toolbelt
export PATH="/usr/local/heroku/bin:$PATH"

# os x/ruby 2.0 ssl fix
export SSL_CERT_FILE=/usr/local/opt/curl-ca-bundle/share/ca-bundle.crt

# load in collection of functions
source ~/bin/proxy.sh
source ~/bin/osx.sh

# environment variables for building debian packages
export DEBFULLNAME="Nick Charlton"
export DEBEMAIL=nick@nickcharlton.net

# AWS (et. al.) secrets
if [ -f ~/.secrets ]; then
    . ~/.secrets
fi

# pull in the aliases
if [ -f ~/.aliases ]; then
    . ~/.aliases
fi

