##
## .bash_profile
##
## This is vaguely split into sections.
## With my custom prompt first,
## followed by shell options
## then path variables for everything I use.
## 

# shell color excapes
COLOR_YELLOW='\e[33m'
COLOR_CYAN='\e[36m'
COLOR_RESET='\e[0m'

# provide the git branch, if present
# a clean branch uses cyan, a dirty branch yellow
prompt_git() {
    git branch &>/dev/null || return 1
    HEAD="$(git symbolic-ref HEAD 2>/dev/null)"
    BRANCH="${HEAD##*/}"
    [[ -n "$(git status 2>/dev/null | \
        grep -F 'working directory clean')" ]] || STATUS=${COLOR_YELLOW}
    printf ${COLOR_CYAN}${STATUS}'(%s)'${COLOR_RESET} "${BRANCH:-unknown}"
}

# enable variables and commands in the prompt
shopt -s promptvars

# set the prompt (like: [user@machine:Current Directory](gitbranch)$)
export PS1='[\u@\h:\W]$(prompt_git)\$ '

# for tmux powerline
export PLATFORM="mac"

# fix a bug with OS X bash and EDITOR
export EDITOR=vim

# set the path
export PATH="/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/opt/X11/bin"

# python
export PYTHONPATH="/usr/local/lib/python2.7/site-packages:$PYTHONPATH"
# haskell
export PATH="$HOME/Library/Haskell/bin:$PATH"
# CUDA
export PATH="/usr/local/cuda/bin:$PATH"
# LaTeX
export PATH="/usr/local/texlive/2012/bin/x86_64-darwin:$PATH"
# Ruby (gems, specifically)
export PATH="/usr/local/opt/ruby/bin:$PATH"
# Heroku Toolbelt
export PATH="/usr/local/heroku/bin:$PATH"

# AWS secret bits
if [ -f ~/.aws_vars ]; then
    . ~/.aws_secrets
fi

# pull in the aliases
if [ -f ~/.bash_aliases ]; then
    . ~/.bash_aliases
fi

